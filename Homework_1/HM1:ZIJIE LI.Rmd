---
title: "assign1"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
#  Data Aggregation using dplyr

```{r}
library(dplyr)
library(tidyr)
library(stringr)
```

```{r}
#read documents
fm <- read.csv('fm.csv')
wine_data <- read.csv('wine_data.csv')
```

```{r}
#1.1
fm %>%
  summarise(number_of_fm = n()) %>%
  drop_na()
```

```{r} 
#1.2
num_of_fm_ma <- fm %>%
  group_by(State) %>%
  summarise(number_of_fm = n()) %>%
  drop_na()
```

```{r}
#1.3
coffee_num <- fm %>%
              filter(State == "Califonia", Coffee == "Y")
```

```{r}
#2.1
index <- str_which(wine_data$designation, regex("20.yr|20.year", ignore_case = T))
wine_num <- dim(wine_data[index,])[1]
```

```{r}
#2.2
wine_data %>%
  group_by(country) %>%
  summarise(mean_price = mean(price, na=T))
```  
  
  
  